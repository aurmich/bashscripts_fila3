<?php

declare(strict_types=1);
/*
 * @see https://coderflex.com/blog/create-advanced-filters-with-filament
 */

namespace Modules\Ptv\Filament\Infolists;

use Filament\Infolists\Components;
use Illuminate\Database\Eloquent\Model;

class Qua00fSection extends Components\Section {
    public static function getDefaultName(): ?string {
        return 'qua00f';
    }

    // non viene chiamato
    //public function mount(Model $record):void {
    //    dddx($record);
    //}

    protected function setUp(): void {
        parent::setUp();
        /*
        dddx([
            get_class_methods($this),
           // 'container'=>$this->getContainer(),
           'getRecord'=>$this->getRecord(),
            ]);
            */
        $this->schema([
            Components\RepeatableEntry::make('qua00f')
                ->schema([
                    Components\TextEntry::make('id'),
                    Components\TextEntry::make('matr'),
                    Components\TextEntry::make('propro'),
                    Components\TextEntry::make('posfun'),
                    Components\TextEntry::make('posiz'),
                    Components\TextEntry::make('categoria_eco'),
                    Components\TextEntry::make('qua2kd'),
                    Components\TextEntry::make('qua2ka'),
                    //Components\TextEntry::make('quaann'),
                    //Components\TextEntry::make('gg'),
                    //Components\TextEntry::make('asz_txt')->,
                    //->columnSpan(2),
                    //Components\TextEntry::make('_gg1')->default(fn()=>dddx($this->getRecord()->posfun_val)),
                   
                    Components\TextEntry::make('_gg')
                        ->default(fn($record)=>$record->gg([
                            'date_max'=>$this->getRecord()->getDateMax(),
                        ])),
                   
                    Components\TextEntry::make('_gg_cateco')
                        ->default(function($record):int{
                            $res=$record->gg(
                                [
                            'date_max'=>$this->getRecord()->getDateMax(),
                            'lista_propro' => $this->getRecord()->lista_propro,
                            'lista_propro_sup' => $this->getRecord()->lista_propro_sup,
                            ]
                            );
                           
                            return $res;
                        }
                    ),

                    Components\TextEntry::make('_gg_cateco_posfun')
                        ->default(function($record):int{
                            $res=$record->gg(
                                [
                            'date_max'=>$this->getRecord()->getDateMax(),
                            'lista_propro' => $this->getRecord()->lista_propro,
                            'lista_propro_sup' => $this->getRecord()->lista_propro_sup,
                            'posfun'    => $this->getRecord()->posfun_val,
                            ]
                            );
                           
                            return $res;
                        }
                    ),
                    
                    
                    
                        
                ])
            ->columns(11),
        ]);
    }
}
